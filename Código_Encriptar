import os
import hashlib
from Cryptodome.Cipher import AES

Clave_Hash = hashlib.new("md5",b"SuperClaveSecreta")
Password = Clave_Hash.digest()

def Encriptar(Mensaje):
    Mensaje = Mensaje
    block_size = 16
    PAD = "0"
    padding = lambda s: s +(block_size - len(s) % block_size) * PAD
    Cifrado = AES.new(Password, AES.MODE_ECB)
    Mensaje_Cifrado = Cifrado.encrypt(padding(Mensaje).encode("utf-8"))
    return Mensaje_Cifrado

def Desencriptar(Mensaje):
    Mensaje = Mensaje
    PAD = "0"
    Descifrar = AES.new(Password, AES.MODE_ECB)
    Descifrado = Descifrar.decrypt(Mensaje).decode("utf-8")
    Indice_pad = Descifrado.find(PAD)
    Mensaje_Descifrado = Descifrado[:Indice_pad]
    return Mensaje_Descifrado

Archivo = open("mensajedeentrada.txt")
Texto_Encriptado = []

while(True):
    Mensaje = Archivo.readline()
    #print(Mensaje)
    
    if len(Mensaje)>=1:  
        Texto_Cifrado = Encriptar(Mensaje)
        print("El texto cifrado es: ")
        print(Texto_Cifrado)
        print("\n")
        Texto_Encriptado.append(Texto_Cifrado)
        Texto_Desencriptado = Desencriptar(Texto_Cifrado)
        print("El mensaje original es: ")
        print(Texto_Desencriptado)
    if not Mensaje:
        break



Archivo.close()

Nuevo_Archivo = open("mensajeseguro.txt","w")
Nuevo_Archivo.writelines("%s\n" % s for s in Texto_Encriptado)
Nuevo_Archivo.close()


